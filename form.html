<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Halacha Q&A</title>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body>
  <div class="container">
    <h1>Halacha Q&A</h1>
    <form id="halacha-form">
      <label for="user_question">Question:</label>
      <textarea id="user_question" name="user_question" required></textarea>

      <label for="community">Community:</label>
      <select id="community" name="community">
        <option value="Modern Orthodox">Modern Orthodox</option>
        <option value="Yeshivish">Yeshivish</option>
        <option value="Hasidic">Hasidic</option>
      </select>

      <button type="submit">Get Answer</button>
    </form>

    <div id="result" class="result" style="display: none;">
      <!-- The answer will be dynamically inserted here -->
    </div>

    <div id="weekly-portion" class="result">
        <h2>This Weeks Portion is:</h2>
        <p>{{ weekly_reading }}</p>
    </div>
  </div>

  <script>
    document.getElementById("halacha-form").addEventListener("submit", async function(e) {
      e.preventDefault();  // Prevent page reload

      const form = e.target;
      const formData = new FormData(form);

      // Send the form data to the FastAPI endpoint
      const response = await fetch("/api/ask", {
        method: "POST",
        body: formData
      });

      if (response.ok) {
        const html = await response.text();
        document.getElementById("result").innerHTML = html;  // Insert the response into the result section
        document.getElementById("result").style.display = "block";  // Show the result section
      } else {
        alert("Error: Unable to get the answer.");
      }
    });

    document.getElementById("weekly-portion").addEventListener("click", async function() {
        const response = await fetch("/api/weekly", {method: "POST"});
        if(response.ok) {
            const text = await response.text();
            document.getElementById("weekly-portion").innerHTML = text;
            document.getElementById("weekly-portion").style.display = "block";  // Make sure it's visible
        } else {
            alert("Error: Unable to get the weekly portion.");
        }
    });
  </script>
</body>
</html>
