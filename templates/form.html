<!DOCTYPE html>
<html lang="{{ 'he' if lang == 'he' else 'en' }}" dir="{{ 'rtl' if lang == 'he' else 'ltr' }}">
<head>
  <meta name="google-adsense-account" content="ca-pub-1056169926227117">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ '专 GPT' if lang == 'he' else 'RavGPT' }}</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-800">
  <div class="min-h-screen flex items-center justify-center p-6">
    <div class="w-full max-w-2xl bg-white rounded-2xl shadow-lg p-8 space-y-6">
      
      <!-- Welcome Screen -->
      <div id="welcome-screen" class="space-y-4">
        <h1 class="text-4xl font-extrabold text-center">
          {{ "专  专 GPT" if lang == "he" else "Welcome to RavGPT" }}
        </h1>
        <button id="start-btn" class="w-full py-3 bg-indigo-600 hover:bg-indigo-700 text-white font-semibold rounded-lg transition">
          {{ "转" if lang == "he" else "Get Started" }}
        </button>
      </div>

      <!-- Affiliation Selection -->
      <div id="affiliation-screen" class="hidden space-y-4">
        <h2 class="text-2xl font-bold">{{ "专 专" if lang == "he" else "Select Your Affiliation" }}</h2>
        <select id="affiliation-select" class="w-full py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
          <option value="Modern Orthodox">{{ "专转拽住" if lang == "he" else "Modern Orthodox" }}</option>
          <option value="Yeshivish">{{ " 砖" if lang == "he" else "Yeshivish" }}</option>
          <option value="Hasidic">{{ "住" if lang == "he" else "Hasidic" }}</option>
        </select>
        <button id="affiliation-next-btn" class="w-full py-2 bg-indigo-600 hover:bg-indigo-700 text-white font-semibold rounded-lg transition">
          {{ "砖" if lang == "he" else "Next" }}
        </button>
      </div>

      <!-- Practice Selection -->
      <div id="practice-screen" class="hidden space-y-4">
        <h2 class="text-2xl font-bold">{{ "专 住专转" if lang == "he" else "Select Your Practice" }}</h2>
        <div class="flex gap-4">
          <button class="practice-btn flex-1 py-2 bg-gray-200 hover:bg-gray-300 rounded-lg transition">
            {{ "砖" if lang == "he" else "Ashkenazi" }}
          </button>
          <button class="practice-btn flex-1 py-2 bg-gray-200 hover:bg-gray-300 rounded-lg transition">
            {{ "住驻专" if lang == "he" else "Sephardic" }}
          </button>
        </div>
      </div>

      <!-- App Screen -->
      <div id="app-screen" class="hidden space-y-6">
        <div class="flex justify-between text-sm text-gray-600">
          <span>{{ "专:" if lang == "he" else "Affiliation:" }} <strong id="summary-affiliation"></strong></span>
          <span>{{ "住专转:" if lang == "he" else "Practice:" }} <strong id="summary-practice"></strong></span>
        </div>

        <!-- Hebrew Date -->
        <div class="text-center text-gray-500">
           {{ hebrew_date }}
        </div>

        <!-- Weekly Portion -->
        <div class="bg-gray-50 p-4 rounded-lg shadow-inner">
          {% include "weekly_section.html" %}
        </div>

        <!-- Q&A Form -->
        <form id="halacha-form" class="space-y-4">
          <textarea id="user_question" name="user_question" rows="4"
            placeholder="{{ '砖 砖 转转...' if lang == 'he' else 'Ask a halachic question...' }}"
            required
            class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"></textarea>
          <input type="hidden" id="community" name="community" />
          <input type="hidden" id="practice" name="practice" />
          <input type="hidden" name="lang" value="{{ lang }}">
          <button type="submit" id="get-answer-btn" class="w-full py-3 bg-green-600 hover:bg-green-700 text-white font-semibold rounded-lg transition">
            <span id="rand-button">{{ "拽 转砖" if lang == "he" else "Get Answer" }}</span>
          </button>
        </form>

        <!-- Loading Indicator -->
        <div id="loading" class="hidden text-center text-indigo-600">
          {{ "注..." if lang == "he" else "Loading..." }}
        </div>

        <!-- Answer Result -->
        <div id="result" class="hidden bg-white p-4 rounded-lg shadow-md space-y-4"></div>
      </div>
    </div>
  </div>
  <script src="/static/script.js" defer></script>
</body>
</html>
